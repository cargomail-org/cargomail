<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1363" height="930"><desc>participant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20self-signed%20or%20CA-signed%20certificate%2C%5Cn%E2%80%A2%20a%20Client%20certificate%20extension%20with%20a%20custom%20OID%20and%20ASN1%3AUTF8String%20value%20is%20used%20as%20a%20global%20client%20identifier%5Cn%20%20in%20respect%20of%20the%20service%20it%20represents%2C%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mss._grip.foo.com%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%5Cn%E2%80%A2%20the%20Client's%20public%20key%20hash%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20e.g.%2C%20client._mss._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20placeholder%20message%5Cn%20%20that%20servers%20as%20an%20access%20control%20list%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20Client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20fingerprint%20(optional)%20contains%20a%20fingerprint%20of%20the%20data%20being%20transmitted%0A%0A%0AClient-%3ERS%3A2.%20Send%20an%20HTTP%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A3.%20Authorization%20decision%5Cn%20%20%20%201.%20the%20client%20is%20authenticated%20via%20the%20DNS%5Cn%20%20%20%20%20%20%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20from%20the%20public%20Client's%20certificate%5Cn%20%20%20%202.%20verify%20the%20token%20signature%5Cn%20%20%20%203.%20validate%20proof-of-possession%5Cn%20%20%20%204.%20verify%20the%20aud%20claim%5Cn%20%20%20%205.%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%206.%20the%20domain%20part%20of%20the%20users's%20email%20address%5Cn%20%20%20%20%20%20%20and%20the%20domain%20part%20of%20the%20custom%20OID's%20value%20from%5Cn%20%20%20%20%20%20%20the%20public%20Client's%20certificate%20must%20match%5Cn%20%20%20%207.%20check%20that%20the%20user's%20email%20address%20is%20present%20in%20the%20placeholder%20message%5Cn%0ARS-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1363" height="930"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 364.84532419585935 46.580460486999996 L 364.84532419585935 881.435004527" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray="10.632380846153845,4.607365033333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.4691570745051 46.580460486999996 L 855.4691570745051 881.435004527" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray="10.632380846153845,4.607365033333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 332.4816842185361 9.399024668000001 L 397.20896417318255 9.399024668000001 L 397.20896417318255 46.580460486999996 L 332.4816842185361 46.580460486999996 L 332.4816842185361 9.399024668000001 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="347.4786574020361" y="32.758365387" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 832.4971839863725 9.399024668000001 L 878.4411301626377 9.399024668000001 L 878.4411301626377 46.580460486999996 L 832.4971839863725 46.580460486999996 L 832.4971839863725 9.399024668000001 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="847.4941571698726" y="32.758365387" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 332.4816842185361 881.435004527 L 397.20896417318255 881.435004527 L 397.20896417318255 918.616440346 L 332.4816842185361 918.616440346 L 332.4816842185361 881.435004527 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="347.4786574020361" y="904.794345246" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 832.4971839863725 881.435004527 L 878.4411301626377 881.435004527 L 878.4411301626377 918.616440346 L 832.4971839863725 918.616440346 L 832.4971839863725 881.435004527 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="847.4941571698726" y="904.794345246" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 6.91104755 74.22465068699998 L 710.3397152517188 74.22465068699998 L 722.7796008417188 86.66453627699998 L 722.7796008417188 202.770135117 L 6.91104755 202.770135117 L 6.91104755 74.22465068699998 M 710.3397152517188 74.22465068699998 L 710.3397152517188 86.66453627699998 L 722.7796008417188 86.66453627699998" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="93.575583827" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="107.397678927" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="121.219774027" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses self-signed or CA-signed certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="135.041869127" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• a Client certificate extension with a custom OID and ASN1:UTF8String value is used as a global client identifier</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="148.86396422700003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  in respect of the service it represents, e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mss._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="162.68605932700004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="176.50815442700005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the Client's public key hash is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="190.33024952700006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., client._mss._grip.foo.com IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 638.3765552333333 223.503277767 L 1060.1218733256771 223.503277767 L 1072.561758915677 235.94316335699997 L 1072.561758915677 310.582476897 L 638.3765552333333 310.582476897 L 638.3765552333333 223.503277767 M 1060.1218733256771 223.503277767 L 1060.1218733256771 235.94316335699997 L 1072.561758915677 235.94316335699997" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="657.7274883733332" y="242.854210907" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="657.7274883733332" y="256.676306007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="657.7274883733332" y="270.498401107" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="657.7274883733332" y="284.320496207" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a placeholder message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="657.7274883733332" y="298.14259130700003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  that servers as an access control list</text></g><g><g><rect fill="white" stroke="none" x="381.2014700641926" y="331.31561954700004" width="424.19661632296874" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="345.13771464700005" width="344.2799598288281" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="358.95980974700007" width="304.57994762179686" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="372.7819048470001" width="460.39662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="386.6039999470001" width="101.64662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="400.4260950470001" width="219.87996593234374" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="414.2481901470001" width="274.44661632296874" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="428.07028524700013" width="375.6133033346875" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="441.89238034700014" width="384.64662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="455.71447544700015" width="251.91329112765624" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="469.53657054700017" width="413.6799537253125" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="483.3586656470002" width="378.64662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="497.1807607470002" width="418.0632850241406" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="381.2014700641926" y="511.0028558470002" width="469.4299537253125" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="343.75550513700006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="357.57760023700007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="371.3996953370001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="385.2217904370001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="399.0438855370001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="412.8659806370001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="426.68807573700013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="440.51017083700015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="454.33226593700016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="468.15436103700017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="481.9764561370002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a Client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="495.7985512370002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="509.6206463370002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="383.27478432919264" y="523.4427414370002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • fingerprint (optional) contains a fingerprint of the data being transmitted</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 364.84532419585935 528.9715794770001 L 420.13370459585934 528.9715794770001 L 420.13370459585934 546.9403031070001 L 376.22551582819267 546.9403031070001" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(364.84532419585935,546.9403031070001) translate(-364.84532419585935,-546.9403031070001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 376.36373677919266 541.1810968153334 L 364.84532419585935 546.9403031070001 L 376.36373677919266 552.6995093986668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="422.68393247369784" y="567.6734457570001" width="374.94661632296874" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="424.75724673869786" y="580.113331347" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTP request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 364.84532419585935 585.6421693870001 L 844.0889654421718 585.6421693870001" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(855.4691570745051,585.6421693870001) translate(-855.4691570745051,-585.6421693870001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 843.9507444911718 579.8829630953334 L 855.4691570745051 585.6421693870001 L 843.9507444911718 591.4013756786668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="871.8253029428384" y="606.375312037" width="153.06330028292967" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="620.1974071369999" width="267.01329723117186" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="634.0195022369999" width="486.94661632296874" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="647.8415973369998" width="189.7299567770703" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="661.6636924369998" width="202.64662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="675.4857875369997" width="154.54662242648436" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="689.3078826369997" width="260.4299537253125" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="703.1299777369996" width="304.04662242648436" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="716.9520728369996" width="344.87996593234374" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="730.7741679369996" width="278.72997203585936" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="744.5962630369995" width="481.97997203585936" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="871.8253029428384" y="758.4183581369995" width="4.14662853" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="618.8151976269999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="632.6372927269998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. the client is authenticated via the DNS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="646.4593878269998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       using the TXT record and the custom OID from the public Client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="660.2814829269997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="674.1035780269997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="687.9256731269996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. verify the aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="701.7477682269996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="715.5698633269996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. the domain part of the users's email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="729.3919584269995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       and the domain part of the custom OID's value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="743.2140535269995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       the public Client's certificate must match</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="757.0361486269994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    7. check that the user's email address is present in the placeholder message</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="873.8986172078385" y="770.8582437269994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.4691570745051 776.387081767 L 910.7575374745052 776.387081767 L 910.7575374745052 794.355805397 L 866.8493487068384 794.355805397" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(855.4691570745051,794.355805397) translate(-855.4691570745051,-794.355805397)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 866.9875696578384 788.5965991053333 L 855.4691570745051 794.355805397 L 866.9875696578384 800.1150116886668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="413.3589202666666" y="815.088948047" width="393.59664073703124" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="415.4322345316666" y="827.5288336369999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 855.4691570745051 833.057671677 L 376.22551582819267 833.057671677" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(364.84532419585935,833.057671677) translate(-364.84532419585935,-833.057671677)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 376.36373677919266 827.2984653853333 L 364.84532419585935 833.057671677 L 376.36373677919266 838.8168779686667 Z"/></g></g></g></g></svg>