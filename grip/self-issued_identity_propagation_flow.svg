<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1838" height="861"><desc>participant%20%22client%22%20as%20Client%0Aparticipant%20%22server%22%20as%20Server%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3Aclient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20self-signed%20or%20CA-signed%20certificate%20with%20a%20certificate%20extension%20containing%20a%20custom%20OID%20and%5Cn%20%20%20ASN1%3AUTF8String%20value%20that%20serves%20as%20a%20global%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mhs._grip.foo.com%5Cn%E2%80%A2%20the%20client's%20public%20key%20fingerprint%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20%20e.g.%2C%20client._mhs._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20f%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20Server%3Aserver%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20CA-signed%20certificate%20with%20an%20appropriate%20Subject%20Alternative%20Name%20(SAN)%5Cn%E2%80%A2%20uses%20a%20DNS%20SRV%20record%20to%20specify%20a%20host%20and%20port%20of%20the%20server%2C%20while%20identifies%20the%20respective%20service%2C%5Cn%20%20%20e.g.%2C%20_mhs._tcp.bar.com%20IN%20SRV%20100%201%202525%20mhs-server.bar.com%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20requesting%20party%20(user)%0AClient-%3EClient%3A1.%20The%20client%20generates%20a%20security%20token%20%E2%80%94%20a%20signed%20(using%20the%20client's%20private%20key)%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biat%2C%20iss%2C%20aud%2C%20sub%2C%20jwks%2C%20dlgr%7Bsub%7D%2C%20token%7D%5Cn%20%20%20%20%E2%80%A2%20iat%3A%20the%20issued-at%20timestamp%20of%20the%20token%5Cn%20%20%20%20%E2%80%A2%20iss%3A%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20client's%20certificate%2C%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%3A%20identifies%20the%20target%20service%20by%20the%20DNS%20SRV%20record%2C%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%20%20%20%20%E2%80%A2%20sub%3A%20identifies%20the%20requesting%20party%20by%20email%20address%2C%20e.g.%2C%20alice.baz.com%5Cn%20%20%20%20%E2%80%A2%20jwks%3A%20holds%20the%20client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%2C%5Cn%20%20%20%20%20%20%20e.g.%2C%20client._mhs._grip.foo.com%5Cn%20%20%20%20%E2%80%A2%20dlgr%7Bsub%7D%3A%20delegator%20%E2%80%94%20the%20client%20who%20had%20incurred%20the%20obligation%20to%20perform%20under%20the%20contract%2C%5Cn%20%20%20%20%20%20%20e.g.%2C%20client._mhs._grip.baz.com%5Cn%20%20%20%20%E2%80%A2%20token%3A%20a%20tokenized%20resource%5Cn%0AClient-%3EServer%3A2.%20Send%20an%20HTTPS%20request%20to%20the%20server%20with%20the%20security%20token%20using%20mTLS%0AServer-%3EServer%3A3.%20authorization%20decision%5Cn%20%20%20%20%E2%80%A2%20the%20client%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20client's%20certificate%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20security%20token%20signature%5Cn%20%20%20%20%E2%80%A2%20validate%20proof-of-possession%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20'aud'%20claim%5Cn%20%20%20%20%E2%80%A2%20validate%20the%20'sub'%20claim%2C%20the%20domain%20part%20of%20the%20requesting%20party%20email%20address%20and%20the%20domain%20part%5Cn%20%20%20%20%20%20%20of%20the%20dlgr%7Bsub%7D%20must%20match%5Cn%20%20%20%20%E2%80%A2%20validate%20the%20tokenized%20resource%0AServer-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1838" height="861"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 335.2286554946875 46.580460486999996 L 335.2286554946875 812.3245290269999" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray="10.632380846153845,4.607365033333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1185.319163178021 46.580460486999996 L 1185.319163178021 812.3245290269999" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray="10.632380846153845,4.607365033333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 303.75668192971773 9.399024668000001 L 366.70062905965716 9.399024668000001 L 366.70062905965716 46.580460486999996 L 303.75668192971773 46.580460486999996 L 303.75668192971773 9.399024668000001 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.75365511321775" y="32.758365387" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1151.3305232006978 9.399024668000001 L 1219.3078031553443 9.399024668000001 L 1219.3078031553443 46.580460486999996 L 1151.3305232006978 46.580460486999996 L 1151.3305232006978 9.399024668000001 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1166.3274963841977" y="32.758365387" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 303.75668192971773 812.3245290269999 L 366.70062905965716 812.3245290269999 L 366.70062905965716 849.5059648459999 L 303.75668192971773 849.5059648459999 L 303.75668192971773 812.3245290269999 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.75365511321775" y="835.6838697459999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1151.3305232006978 812.3245290269999 L 1219.3078031553443 812.3245290269999 L 1219.3078031553443 849.5059648459999 L 1151.3305232006978 849.5059648459999 L 1151.3305232006978 812.3245290269999 Z" stroke-miterlimit="10" stroke-width="2.211535216" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1166.3274963841977" y="835.6838697459999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 6.91104755 74.22465068699998 L 651.106377849375 74.22465068699998 L 663.546263439375 86.66453627699998 L 663.546263439375 188.94804001699998 L 6.91104755 188.94804001699998 L 6.91104755 74.22465068699998 M 651.106377849375 74.22465068699998 L 651.106377849375 86.66453627699998 L 663.546263439375 86.66453627699998" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="93.57558382699996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="107.39767892699996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="121.21977402699996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed or CA-signed certificate with a certificate extension containing a custom OID and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="135.04186912699996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   ASN1:UTF8String value that serves as a global client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="148.86396422699997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="162.68605932699998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the client's public key fingerprint is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="26.261980689999973" y="176.508154427" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., client._mhs._grip.foo.com IN TXT  "v=grip1; h=sha256; f=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 853.2348926356773 209.68118266699997 L 1504.9635481303649 209.68118266699997 L 1517.4034337203648 222.12106825699996 L 1517.4034337203648 310.582476897 L 853.2348926356773 310.582476897 L 853.2348926356773 209.68118266699997 M 1504.9635481303649 209.68118266699997 L 1504.9635481303649 222.12106825699996 L 1517.4034337203648 222.12106825699996" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="229.03211580700003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="242.85421090700004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="256.67630600700005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a CA-signed certificate with an appropriate Subject Alternative Name (SAN)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="270.49840110700006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a DNS SRV record to specify a host and port of the server, while identifies the respective service,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="284.3204962070001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., _mhs._tcp.bar.com IN SRV 100 1 2525 mhs-server.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="872.5858257756772" y="298.1425913070001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the requesting party (user)</text></g><g><g><rect fill="white" stroke="none" x="351.58480136302074" y="331.3156195469999" width="828.89662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="345.13771464699994" width="275.8633033346875" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="358.95980974699995" width="276.64662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="372.78190484699996" width="544.89662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="386.603999947" width="517.89662853" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="400.426095047" width="468.6133033346875" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="414.248190147" width="787.5132667135938" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="428.070285247" width="214.71329417941405" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="441.892380347" width="614.8633033346875" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="455.71447544700004" width="217.2799598288281" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="469.53657054700005" width="196.79662242648436" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="351.58480136302074" y="483.35866564700007" width="4.14662853" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="343.75550513699994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. The client generates a security token — a signed (using the client's private key) DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="357.57760023699996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iat, iss, aud, sub, jwks, dlgr{sub}, token}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="371.39969533699997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iat: the issued-at timestamp of the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="385.221790437" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss: identifies who issues the token — CN from public client's certificate, e.g., foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="399.043885537" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud: identifies the target service by the DNS SRV record, e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="412.865980637" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub: identifies the requesting party by email address, e.g., alice.baz.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="426.688075737" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks: holds the client's certificate public key in the JWK Set format (alternatively provide JWK Set by URI using jwks_uri claim),</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="440.51017083700003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g., client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="454.33226593700005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • dlgr{sub}: delegator — the client who had incurred the obligation to perform under the contract,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="468.15436103700006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g., client._mhs._grip.baz.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="481.97645613700007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • token: a tokenized resource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="353.65811562802077" y="495.7985512370001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 335.2286554946875 501.32738927699995 L 390.51703589468747 501.32738927699995 L 390.51703589468747 519.296112907 L 346.6088471270208 519.296112907" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(335.2286554946875,519.296112907) translate(-335.2286554946875,-519.296112907)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 346.7470680780208 513.5369066153332 L 335.2286554946875 519.296112907 L 346.7470680780208 525.0553191986667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="532.1172668242839" y="540.0292555569999" width="456.3132850241406" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="534.1905810892839" y="552.4691411469998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTPS request to the server with the security token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 335.2286554946875 557.9979791869999 L 1173.9389715456875 557.9979791869999" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(1185.319163178021,557.9979791869999) translate(-1185.319163178021,-557.9979791869999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1173.8007505946875 552.2387728953332 L 1185.319163178021 557.9979791869999 L 1173.8007505946875 563.7571854786667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="578.7311218369999" width="152.1966315817578" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="592.5532169369999" width="551.5132667135938" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="606.3753120369998" width="232.87996593234374" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="620.1974071369998" width="237.07996288058592" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="634.0195022369998" width="198.2799598288281" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="647.8415973369997" width="156.7799598288281" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="661.6636924369997" width="631.7299415182813" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="675.4857875369996" width="205.7799598288281" height="17.96872363"/></g><g><rect fill="white" stroke="none" x="1201.6753090463544" y="689.3078826369996" width="219.6966315817578" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="591.1710074269998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="604.9931025269998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the client is authenticated via the DNS using the TXT record and the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="618.8151976269997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="632.6372927269997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the security token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="646.4593878269997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="660.2814829269996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the 'aud' claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="674.1035780269996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate the 'sub' claim, the domain part of the requesting party email address and the domain part</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="687.9256731269995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       of the dlgr{sub} must match</text><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1203.7486233113543" y="701.7477682269995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate the tokenized resource</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1185.319163178021 707.2766062669999 L 1240.607543578021 707.2766062669999 L 1240.607543578021 725.2453298969999 L 1196.6993548103544 725.2453298969999" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(1185.319163178021,725.2453298969999) translate(-1185.319163178021,-725.2453298969999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1196.8375757613544 719.4861236053332 L 1185.319163178021 725.2453298969999 L 1196.8375757613544 731.0045361886666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="563.4755889678386" y="745.9784725469999" width="393.59664073703124" height="17.96872363"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="9pt" font-style="normal" font-weight="normal" text-decoration="normal" x="565.5489032328386" y="758.4183581369998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1185.319163178021 763.9471961769999 L 346.6088471270208 763.9471961769999" stroke-miterlimit="10" stroke-width="1.1518412583333333" stroke-dasharray=""/><g transform="translate(335.2286554946875,763.9471961769999) translate(-335.2286554946875,-763.9471961769999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 346.7470680780208 758.1879898853332 L 335.2286554946875 763.9471961769999 L 346.7470680780208 769.7064024686666 Z"/></g></g></g></g></svg>