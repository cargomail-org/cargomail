<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1340" height="862"><desc>participant%20%22client%22%20as%20Client%0Aparticipant%20%22server%22%20as%20Server%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3Aclient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20self-signed%20or%20CA-signed%20certificate%20with%20a%20certificate%20extension%20containing%20a%20custom%20OID%20and%5Cn%20%20%20ASN1%3AUTF8String%20value%20that%20serves%20as%20a%20global%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mhs._grip.foo.com%5Cn%E2%80%A2%20the%20client's%20public%20key%20hash%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20%20e.g.%2C%20client._mhs._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20Server%3Aserver%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20self-signed%20or%20CA-signed%20certificate%20with%20the%20CN%20matching%20the%20server's%20hostname%2C%5Cn%20%20%20and%20with%20a%20certificate%20extension%20containing%20a%20custom%20OID%20and%20ASN1%3AUTF8String%20value%20that%5Cn%20%20%20serves%20as%20a%20global%20server%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aserver._mhs._grip.bar.com%5Cn%E2%80%A2%20the%20server's%20public%20key%20hash%20is%20published%20on%20the%20server%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20%20e.g.%2C%20server._mhs._grip.bar.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd54dcc9743757c7c9f%20...%20a13a%22%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%20and%20makes%20authorization%20decisions%5Cn%20%20%20using%20a%20placeholder%20message%20that%20servers%20as%20an%20access%20control%20list%0AClient-%3EClient%3A1.%20the%20client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20client's%20certificate%2C%5Cn%20%20%20%20%20%20%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20server%20URI%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20%20(client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20fingerprint%20(optional)%20contains%20a%20fingerprint%20of%20the%20data%20being%20transmitted%0AClient-%3EServer%3A2.%20Send%20an%20HTTPS%20request%20to%20the%20server%20with%20the%20token%20using%20mTLS%20after%20authorization%20decision%5Cn%20%20%20%20%E2%80%A2%20the%20server%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20server's%20certificate%5Cn%20%20%20%20%E2%80%A2%20the%20CN%20must%20mach%20the%20server's%20hostname%5Cn%20%20%20%20%E2%80%A2%20the%20domain%20part%20of%20the%20author's%20email%20address%20or%20one%20of%20the%20recipient's%20email%20addresses%5Cn%20%20%20%20%20%20%20listed%20in%20the%20placeholder%20message%20and%20the%20domain%20part%20of%20the%20custom%20OID%20value%20from%5Cn%20%20%20%20%20%20%20the%20public%20server's%20certificate%20must%20match%0AServer-%3EServer%3A3.%20Authorization%20decision%5Cn%20%20%20%20%E2%80%A2%20the%20client%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20client's%20certificate%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20token%20signature%5Cn%20%20%20%20%E2%80%A2%20validate%20proof-of-possession%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20aud%20claim%5Cn%20%20%20%20%E2%80%A2%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%20%E2%80%A2%20the%20domain%20part%20of%20the%20author's%20email%20address%20or%20one%20of%20the%20recipient's%20email%20addresses%5Cn%20%20%20%20%20%20%20listed%20in%20the%20placeholder%20message%20and%20the%20domain%20part%20of%20the%20custom%20OID%20value%20from%5Cn%20%20%20%20%20%20%20the%20public%20client's%20certificate%20must%20match%5Cn%20%20%20%20%E2%80%A2%20check%20that%20the%20user's%20email%20address%20is%20listed%20in%20the%20placeholder%20message%0AServer-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1340" height="862"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 295.45374991468753 38.111285853 L 295.45374991468753 822.9549767130002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 830.4777170158595 38.111285853 L 830.4777170158595 822.9549767130002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 268.57516554054104 7.690111091999997 L 322.332334288834 7.690111091999997 L 322.332334288834 38.111285853 L 268.57516554054104 38.111285853 L 268.57516554054104 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="280.84541632704105" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 801.3657990540665 7.690111091999997 L 859.5896349776525 7.690111091999997 L 859.5896349776525 38.111285853 L 801.3657990540665 38.111285853 L 801.3657990540665 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="813.6360498405666" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 268.57516554054104 822.9549767130002 L 322.332334288834 822.9549767130002 L 322.332334288834 853.3761514740002 L 268.57516554054104 853.3761514740002 L 268.57516554054104 822.9549767130002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="280.84541632704105" y="842.0671645740002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 801.3657990540665 822.9549767130002 L 859.5896349776525 822.9549767130002 L 859.5896349776525 853.3761514740002 L 801.3657990540665 853.3761514740002 L 801.3657990540665 822.9549767130002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="813.6360498405666" y="842.0671645740002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.65449345 60.729259652999986 L 575.074918169375 60.729259652999986 L 585.253006379375 70.90734786299998 L 585.253006379375 154.593850923 L 5.65449345 154.593850923 L 5.65449345 60.729259652999986 M 575.074918169375 60.729259652999986 L 575.074918169375 70.90734786299998 L 585.253006379375 70.90734786299998" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="76.561841313" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="87.87082821300001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="99.17981511300002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed or CA-signed certificate with a certificate extension containing a custom OID and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="110.48880201300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   ASN1:UTF8String value that serves as a global client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="121.79778891300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="133.10677581300004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the client's public key hash is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="144.41576271300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., client._mhs._grip.foo.com IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 556.1284727582033 171.55733127300002 L 1094.6488730635158 171.55733127300002 L 1104.8269612735157 181.73541948300002 L 1104.8269612735157 299.34888324300005 L 556.1284727582033 299.34888324300005 L 556.1284727582033 171.55733127300002 M 1094.6488730635158 171.55733127300002 L 1094.6488730635158 181.73541948300002 L 1104.8269612735157 181.73541948300002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="187.38991293300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="198.69889983300004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="210.00788673300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed or CA-signed certificate with the CN matching the server's hostname,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="221.31687363300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   and with a certificate extension containing a custom OID and ASN1:UTF8String value that</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="232.62586053300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   serves as a global server identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="243.93484743300007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:server._mhs._grip.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="255.24383433300008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the server's public key hash is published on the server domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="266.5528212330001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., server._mhs._grip.bar.com IN TXT  "v=grip1; h=sha256; p=d54dcc9743757c7c9f ... a13a"</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="277.86180813300007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user and makes authorization decisions</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="571.9610544182033" y="289.17079503300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   using a placeholder message that servers as an access control list</text></g><g><g><rect fill="white" stroke="none" x="308.83605107968754" y="316.312363593" width="393.6093708746875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="327.62135049299997" width="305.0426899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="338.93033739299995" width="269.8593708746875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="350.2393242929999" width="406.4260212653125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="361.5483111929999" width="96.60936324529297" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="372.8572980929999" width="214.24270217351562" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="384.16628499299986" width="243.10935561589844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="395.47527189299984" width="336.14269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="406.7842587929998" width="342.64269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="418.0932456929998" width="223.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="429.4022325929998" width="364.9760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="440.71121949299976" width="338.84270827703125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="452.02020639299974" width="370.4760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968754" y="463.3291932929997" width="415.9593769782031" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="326.490451803" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. the client generates a token — a signed, using the client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="337.79943870299996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="349.10842560299994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="360.4174125029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="371.7263994029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g., foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="383.0353863029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target server URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="394.34437320299986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="405.65336010299984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="416.9623470029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       (client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="428.2713339029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="439.5803208029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="450.88930770299976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="462.19829460299974" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.53239911468756" y="473.5072815029997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • fingerprint (optional) contains a fingerprint of the data being transmitted</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 295.45374991468753 478.0308762630001 L 340.6896975146875 478.0308762630001 L 340.6896975146875 492.7325592330001 L 304.7648157956875 492.7325592330001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(295.45374991468753,492.7325592330001) translate(-295.45374991468753,-492.7325592330001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.87790566468755 488.0204813580001 L 295.45374991468753 492.7325592330001 L 304.87790566468755 497.44463710800005 Z"/></g></g><g><g><rect fill="white" stroke="none" x="308.83605107968765" y="509.69603958300013" width="508.2593647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="521.0050264830002" width="493.34270827703125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="532.3140133830002" width="210.67603652410156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="543.6230002830002" width="248.87603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="554.9319871830003" width="492.2926899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="566.2409740830003" width="480.4760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="308.83605107968765" y="577.5499609830003" width="249.77602736882812" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="519.8741277930002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTPS request to the server with the token using mTLS after authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="531.1831146930002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the server is authenticated via the DNS using the TXT record and the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="542.4921015930003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public server's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="553.8010884930003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the CN must mach the server's hostname</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="565.1100753930003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the domain part of the author's email address or one of the recipient's email addresses</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="576.4190622930004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       listed in the placeholder message and the domain part of the custom OID value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="310.5323991146877" y="587.7280491930004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       the public server's certificate must match</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 295.45374991468753 592.2516439530001 L 821.1666511348595 592.2516439530001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(830.4777170158595,592.2516439530001) translate(-830.4777170158595,-592.2516439530001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 821.0535612658596 587.5395660780001 L 830.4777170158595 592.2516439530001 L 821.0535612658596 596.9637218280001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="843.8600181808595" y="609.215124303" width="135.4426991217578" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="620.5241112030001" width="488.87603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="631.8330981030001" width="206.20936171941406" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="643.1420850030001" width="164.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="654.4510719030002" width="175.54268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="665.7600588030002" width="132.89269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="677.0690457030003" width="226.79268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="688.3780326030003" width="492.2926899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="699.6870195030003" width="480.4760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="710.9960064030004" width="245.3093678229297" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="843.8600181808595" y="722.3049933030004" width="411.7926899664844" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="619.3932125130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="630.7021994130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the client is authenticated via the DNS using the TXT record and the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="642.0111863130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="653.3201732130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="664.6291601130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="675.9381470130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="687.2471339130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="698.5561208130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the domain part of the author's email address or one of the recipient's email addresses</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="709.8651077130004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       listed in the placeholder message and the domain part of the custom OID value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="721.1740946130004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       the public client's certificate must match</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.5563662158595" y="732.4830815130005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • check that the user's email address is listed in the placeholder message</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 830.4777170158595 737.0066762730002 L 875.7136646158596 737.0066762730002 L 875.7136646158596 751.7083592430001 L 839.7887828968595 751.7083592430001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(830.4777170158595,751.7083592430001) translate(-830.4777170158595,-751.7083592430001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 839.9018727658595 746.9962813680002 L 830.4777170158595 751.7083592430001 L 839.9018727658595 756.4204371180001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="388.5777197808595" y="768.6718395930002" width="348.7760273688281" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.27406781585955" y="778.8499278030002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 830.4777170158595 783.3735225630002 L 304.7648157956875 783.3735225630002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(295.45374991468753,783.3735225630002) translate(-295.45374991468753,-783.3735225630002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 304.87790566468755 778.6614446880002 L 295.45374991468753 783.3735225630002 L 304.87790566468755 788.0856004380001 Z"/></g></g></g></g></svg>