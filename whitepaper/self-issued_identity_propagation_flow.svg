<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1756" height="954"><desc>participant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20self-signed%20or%20CA-signed%20certificate%2C%5Cn%E2%80%A2%20a%20custom%20extension%20with%20a%20custom%20OID%20of%20the%20Client%20certificate%20is%20used%20as%20a%20global%20client%20identifier%5Cn%20%20in%20respect%20of%20the%20service%20it%20represents%2C%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mss._grip.foo.com%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%5Cn%E2%80%A2%20the%20Client's%20public%20key%20hash%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20e.g.%2C%20client._mss._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20Client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20fingerprint%20(optional)%20contains%20a%20fingerprint%20of%20the%20data%20being%20transmitted%0A%0A%0AClient-%3ERS%3A2.%20Send%20an%20HTTP%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A3.%20Authorization%20decision%5Cn%20%20%20%201.%20the%20client%20is%20authenticated%20via%20the%20DNS%5Cn%20%20%20%20%20%20%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20from%20the%20public%20Client's%20certificate%5Cn%20%20%20%202.%20verify%20the%20token%20signature%5Cn%20%20%20%203.%20validate%20proof-of-possession%5Cn%20%20%20%204.%20verify%20the%20aud%20claim%5Cn%20%20%20%205.%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%206.%20the%20domain%20part%20of%20the%20users's%20email%20address%5Cn%20%20%20%20%20%20%20and%20the%20domain%20part%20of%20the%20custom%20OID's%20value%20from%20the%20public%20Client's%20certificate%20must%20match%0ARS-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1756" height="954"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 411.20775257179685 50.815047804 L 411.20775257179685 901.2508626840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1006.4685809553906 50.815047804 L 1006.4685809553906 901.2508626840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 373.6640857465595 10.253481456000003 L 448.7514193970341 10.253481456000003 L 448.7514193970341 50.815047804 L 373.6640857465595 50.815047804 L 373.6640857465595 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.02442012855954" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 980.3749129857441 10.253481456000003 L 1032.562248925037 10.253481456000003 L 1032.562248925037 50.815047804 L 980.3749129857441 50.815047804 L 980.3749129857441 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.7352473677441" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 373.6640857465595 901.2508626840001 L 448.7514193970341 901.2508626840001 L 448.7514193970341 941.8124290320002 L 373.6640857465595 941.8124290320002 L 373.6640857465595 901.2508626840001 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="390.02442012855954" y="926.7337798320001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 980.3749129857441 901.2508626840001 L 1032.562248925037 901.2508626840001 L 1032.562248925037 941.8124290320002 L 980.3749129857441 941.8124290320002 L 980.3749129857441 901.2508626840001 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.7352473677441" y="926.7337798320001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620400002 L 801.3053962635937 80.97234620400002 L 814.8761805435937 94.54313048400002 L 814.8761805435937 221.20378376400004 L 7.5393246000000005 221.20378376400004 L 7.5393246000000005 80.97234620400002 M 801.3053962635937 80.97234620400002 L 801.3053962635937 94.54313048400002 L 814.8761805435937 94.54313048400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.08245508400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.16110428400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.23975348400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses self-signed or CA-signed certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="147.31840268400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• a custom extension with a custom OID of the Client certificate is used as a global client identifier</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="162.39705188400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  in respect of the service it represents, e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mss._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="177.47570108400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="192.55435028400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the Client's public key hash is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="207.63299948400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., client._mss._grip.foo.com IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 755.6418125294922 243.821757564 L 1243.724565101289 243.821757564 L 1257.295349381289 257.392541844 L 1257.295349381289 323.738598324 L 755.6418125294922 323.738598324 L 755.6418125294922 243.821757564 M 1243.724565101289 243.821757564 L 1243.724565101289 257.392541844 L 1257.295349381289 257.392541844" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.7519214094922" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.7519214094922" y="280.01051564399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.7519214094922" y="295.0891648439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.7519214094922" y="310.1678140439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text></g><g><g><rect fill="white" stroke="none" x="429.0508207917968" y="346.3565721240001" width="516.9236191740625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="361.43522132400005" width="419.4902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="376.513870524" width="371.07358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="391.592519724" width="561.0069321623438" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="406.67116892399997" width="123.39026346117187" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="421.74981812399994" width="267.6902512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="436.8284673239999" width="334.29025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="451.9071165239999" width="457.5902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="466.98576572399986" width="468.75693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="482.06441492399983" width="306.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="497.1430641239998" width="504.07358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="512.2217133239998" width="461.4402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="527.3003625239998" width="509.47360696703123" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="429.0508207917968" y="542.3790117239997" width="572.1402329435938" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="359.9273564040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="375.00600560400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="390.084654804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="405.163304004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="420.24195320399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="435.32060240399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="450.3992516039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="465.4779008039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="480.55655000399986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="495.63519920399983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="510.7138484039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a Client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="525.7924976039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="540.8711468039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="431.3126181717968" y="555.9497960039997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • fingerprint (optional) contains a fingerprint of the data being transmitted</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 411.20775257179685 561.9812556840001 L 471.52234937179685 561.9812556840001 L 471.52234937179685 581.5834996440001 L 423.62250707979683 581.5834996440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(411.20775257179685,581.5834996440001) translate(-411.20775257179685,-581.5834996440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 423.77329357179684 575.3007291440001 L 411.20775257179685 581.5834996440001 L 423.77329357179684 587.866270144 Z"/></g></g><g><g><rect fill="white" stroke="none" x="480.36804113652346" y="604.201473444" width="456.9402512541406" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="482.6298385165235" y="617.772257724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTP request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 411.20775257179685 623.803717404 L 994.0538264473906 623.803717404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1006.4685809553906,623.803717404) translate(-1006.4685809553906,-623.803717404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 993.9030399553906 617.5209469040001 L 1006.4685809553906 623.803717404 L 993.9030399553906 630.086487904 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="646.4216912040001" width="186.17358865648438" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="661.5003404040001" width="325.1902512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="676.5789896040001" width="593.4736069670313" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="691.657638804" width="230.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="706.736288004" width="246.62360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="721.814937204" width="187.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="736.893586404" width="317.14026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="751.9722356039999" width="370.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1024.3116491753908" y="767.0508848039999" width="727.2236069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="659.9924754840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="675.0711246840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. the client is authenticated via the DNS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="690.1497738840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       using the TXT record and the custom OID from the public Client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="705.228423084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="720.307072284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="735.385721484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. verify the aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="750.464370684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="765.5430198839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. the domain part of the users's email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1026.5734465553908" y="780.6216690839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       and the domain part of the custom OID's value from the public Client's certificate must match</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1006.4685809553906 786.6531287640001 L 1066.7831777553906 786.6531287640001 L 1066.7831777553906 806.2553727240002 L 1018.8833354633906 806.2553727240002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1006.4685809553906,806.2553727240002) translate(-1006.4685809553906,-806.2553727240002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1019.0341219553907 799.9726022240002 L 1006.4685809553906 806.2553727240002 L 1019.0341219553907 812.5381432240001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="468.99304113652346" y="828.8733465240001" width="479.6902512541406" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="471.2548385165235" y="842.4441308040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1006.4685809553906 848.4755904840001 L 423.62250707979683 848.4755904840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(411.20775257179685,848.4755904840001) translate(-411.20775257179685,-848.4755904840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 423.77329357179684 842.1928199840002 L 411.20775257179685 848.4755904840001 L 423.77329357179684 854.7583609840001 Z"/></g></g></g></g></svg>